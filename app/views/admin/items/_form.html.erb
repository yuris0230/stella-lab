<div class="app-section-card">
  <%= form_with model: [:admin, @item], local: true do |f| %>
    <% if @item.errors.any? %>
      <div class="form-errors">
        <strong><%= pluralize(@item.errors.count, "error") %> prevented saving:</strong>
        <ul>
          <% @item.errors.full_messages.each do |msg| %>
            <li><%= msg %></li>
          <% end %>
        </ul>
      </div>
    <% end %>

    <!-- Name -->
    <div class="app-form-group">
      <%= f.label :name, "Name", class: "app-form-label" %>
      <%= f.text_field :name, class: "app-form-control" %>
    </div>

    <!-- Rarity -->
    <div class="app-form-group">
      <%= f.label :rarity, "Rarity", class: "app-form-label" %>
      <%= f.select :rarity,
                   Item.rarities.keys.map { |r| [r.upcase, r] },
                   { include_blank: "Select rarity" },
                   class: "app-form-control" %>
    </div>

    <!-- Item type -->
    <div class="app-form-group">
      <%= f.label :item_type, "Type", class: "app-form-label" %>
      <%= f.select :item_type,
                   Item.item_types.keys.map { |t| [t.titleize, t] },
                   { include_blank: "Select type" },
                   class: "app-form-control" %>
    </div>

    <!-- Summary -->
    <div class="app-form-group">
      <%= f.label :summary, "Summary", class: "app-form-label" %>
      <%= f.text_area :summary, rows: 3, class: "app-form-control" %>
    </div>

    <!-- Icon image -->
    <div class="app-form-group">
      <%= f.label :icon, "Icon image", class: "app-form-label" %>
      <%= f.file_field :icon, accept: "image/*", class: "app-form-control" %>

      <% if @item.icon.attached? %>
        <div style="margin-top: 8px;">
          <%= image_tag @item.icon.variant(resize_to_fill: [80, 80]) %>
        </div>
      <% end %>
    </div>

    <!-- Publish flag -->
    <div class="app-form-group">
      <label class="app-checkbox">
        <%= f.check_box :is_published %>
        <span>Publish on site</span>
      </label>
    </div>

    <!-- Actions -->
    <div class="form-actions">
      <%= f.submit "Save item", class: "app-button-primary" %>
      <%= link_to "Cancel", admin_items_path, class: "app-button-secondary" %>
    </div>
  <% end %>
</div>